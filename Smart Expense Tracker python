from datetime import datetime
from collections import defaultdict

# Sample expense data
expenses = [
    {"date": "2025-10-01", "category": "Groceries", "amount": 1200},
    {"date": "2025-10-02", "category": "Transport", "amount": 300},
    {"date": "2025-10-03", "category": "Dining", "amount": 850},
    {"date": "2025-10-04", "category": "Groceries", "amount": 950},
    {"date": "2025-10-05", "category": "Entertainment", "amount": 1500},
    {"date": "2025-10-06", "category": "Dining", "amount": 400},
    {"date": "2025-10-07", "category": "Transport", "amount": 250},
    {"date": "2025-10-08", "category": "Bills", "amount": 2200},
    {"date": "2025-10-09", "category": "Groceries", "amount": 1100},
]

# Monthly budget per category
budget = {
    "Groceries": 3000,
    "Transport": 1000,
    "Dining": 1500,
    "Entertainment": 1000,
    "Bills": 2500
}

# Aggregation
def analyze_expenses(expenses, budget):
    category_totals = defaultdict(float)
    overspending = []

    for entry in expenses:
        category = entry["category"]
        amount = entry["amount"]
        category_totals[category] += amount

    print("\nğŸ“Š Expense Summary:")
    print("-" * 50)
    for category, total in category_totals.items():
        limit = budget.get(category, None)
        status = ""
        if limit:
            if total > limit:
                status = "âš ï¸ Over Budget"
                overspending.append((category, total, limit))
            else:
                status = "âœ… Within Budget"
        else:
            status = "â„¹ï¸ No Budget Set"
        print(f"{category:<15} | â‚¹{total:>7.2f} | {status}")
    print("-" * 50)

    if overspending:
        print("\nğŸš¨ Overspending Detected:")
        for cat, spent, limit in overspending:
            print(f"- {cat}: Spent â‚¹{spent:.2f}, Budget â‚¹{limit:.2f} (Over by â‚¹{spent - limit:.2f})")
    else:
        print("\nâœ… All categories within budget.")

# Run analysis
analyze_expenses(expenses, budget)
